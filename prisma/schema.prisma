// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "sqlite"
}

enum HttpMethod {
  GET
  POST
  PUT
  PATCH
  DELETE
  HEAD
  OPTIONS
}

model MockEndpoint {
  id          String       @id @default(cuid())
  method      HttpMethod   // Enum вместо String
  path        String       // /api/items
  description String?
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  presets     MockPreset[]

  @@unique([method, path])
  @@index([method, path]) // Для быстрого поиска
}

model MockPreset {
  id             String       @id @default(cuid())
  name           String       // "Success case", "Empty response", "Error 500"
  enabled        Boolean      @default(false)
  statusCode     Int          @default(200) // HTTP статус код
  responseData   Json         // Данные для ответа
  filterKeys     Json?        @default("[]") // ["colors", "status"] - массив строк в JSON формате
  mockEndpointId String
  mockEndpoint   MockEndpoint @relation(fields: [mockEndpointId], references: [id], onDelete: Cascade)
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  @@index([mockEndpointId])
  @@index([mockEndpointId, enabled]) // Для быстрого поиска активного пресета
}
